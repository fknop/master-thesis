<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Benchmark</title>
  <script src="https://code.highcharts.com/highcharts.js"></script>
  <script src="https://code.highcharts.com/highcharts-more.js"></script>
  <script src="https://code.highcharts.com/modules/series-label.js"></script>
  <script src="https://code.highcharts.com/modules/exporting.js"></script>
  <script src="https://code.highcharts.com/modules/export-data.js"></script>
  <style>
    #container0, #container1 {
      min-width: 310px;
      max-width: 1000px;
      height: 400px;
      margin: 0 auto
    }
  </style>
</head>
<body>
  

    <div id="container0"></div>
    <div id="container1"></div>



  <script>
    const data = {
    "repeat": 1,
    "dryRun": 1,
    "timeLimit": 20,
    "solutionLimit": 1,
    "problems": [
        {
            "T": 15,
            "D": 30,
            "W": 300
        },
        {
            "T": 15,
            "D": 30,
            "W": 300
        },
        {
            "T": 15,
            "D": 30,
            "W": 300
        },
        {
            "T": 15,
            "D": 50,
            "W": 300
        },
        {
            "T": 15,
            "D": 50,
            "W": 300
        },
        {
            "T": 15,
            "D": 50,
            "W": 300
        }
    ],
    "timeSeries": [
        {
            "name": "CP-MA",
            "results": [
                {
                    "min": 986,
                    "max": 986,
                    "mean": 986,
                    "stdev": 0
                },
                {
                    "min": 1491,
                    "max": 1491,
                    "mean": 1491,
                    "stdev": 0
                },
                {
                    "min": 979,
                    "max": 979,
                    "mean": 979,
                    "stdev": 0
                },
                {
                    "min": 1424,
                    "max": 1424,
                    "mean": 1424,
                    "stdev": 0
                },
                {
                    "min": 1482,
                    "max": 1482,
                    "mean": 1482,
                    "stdev": 0
                },
                {
                    "min": 1259,
                    "max": 1259,
                    "mean": 1259,
                    "stdev": 0
                }
            ]
        },
        {
            "name": "CP-FF",
            "results": [
                {
                    "min": 1927,
                    "max": 1927,
                    "mean": 1927,
                    "stdev": 0
                },
                {
                    "min": 2959,
                    "max": 2959,
                    "mean": 2959,
                    "stdev": 0
                },
                {
                    "min": 1845,
                    "max": 1845,
                    "mean": 1845,
                    "stdev": 0
                },
                {
                    "min": 2749,
                    "max": 2749,
                    "mean": 2749,
                    "stdev": 0
                },
                {
                    "min": 3176,
                    "max": 3176,
                    "mean": 3176,
                    "stdev": 0
                },
                {
                    "min": 2552,
                    "max": 2552,
                    "mean": 2552,
                    "stdev": 0
                }
            ]
        }
    ],
    "objectiveSeries": [
        {
            "name": "CP-MA",
            "results": [
                {
                    "min": 401,
                    "max": 401,
                    "mean": 401,
                    "stdev": 0
                },
                {
                    "min": 683,
                    "max": 683,
                    "mean": 683,
                    "stdev": 0
                },
                {
                    "min": 453,
                    "max": 453,
                    "mean": 453,
                    "stdev": 0
                },
                {
                    "min": 509,
                    "max": 509,
                    "mean": 509,
                    "stdev": 0
                },
                {
                    "min": 604,
                    "max": 604,
                    "mean": 604,
                    "stdev": 0
                },
                {
                    "min": 484,
                    "max": 484,
                    "mean": 484,
                    "stdev": 0
                }
            ]
        },
        {
            "name": "CP-FF",
            "results": [
                {
                    "min": 1516,
                    "max": 1516,
                    "mean": 1516,
                    "stdev": 0
                },
                {
                    "min": 1828,
                    "max": 1828,
                    "mean": 1828,
                    "stdev": 0
                },
                {
                    "min": 1493,
                    "max": 1493,
                    "mean": 1493,
                    "stdev": 0
                },
                {
                    "min": 1719,
                    "max": 1719,
                    "mean": 1719,
                    "stdev": 0
                },
                {
                    "min": 1838,
                    "max": 1838,
                    "mean": 1838,
                    "stdev": 0
                },
                {
                    "min": 1669,
                    "max": 1669,
                    "mean": 1669,
                    "stdev": 0
                }
            ]
        },
        {
            "name": "Lowerbound",
            "results": [
                {
                    "min": 149,
                    "max": 149,
                    "mean": 149,
                    "stdev": 0
                },
                {
                    "min": 192,
                    "max": 192,
                    "mean": 192,
                    "stdev": 0
                },
                {
                    "min": 155,
                    "max": 155,
                    "mean": 155,
                    "stdev": 0
                },
                {
                    "min": 164,
                    "max": 164,
                    "mean": 164,
                    "stdev": 0
                },
                {
                    "min": 183,
                    "max": 183,
                    "mean": 183,
                    "stdev": 0
                },
                {
                    "min": 163,
                    "max": 163,
                    "mean": 163,
                    "stdev": 0
                }
            ]
        }
    ]
}

    const categories = data.problems
    const titles = ['Runtime', 'Objective']
    const yAxis = ['Runtime (ms)', 'Objective (lower is better)']

    function lineSeries(serie) {
      return serie.map(s => ({...s, type: 'spline'}))
    }

    function columnSeries(serie) {
      return serie.map(s => ({...s, type: 'column'}))
    }

    function scatterSeries(serie) {
      return serie.map(s => ({...s, type: 'scatter'}))
    }


    const timeSeries = data.timeSeries.map(s => ({
      name: s.name,
      id: s.name,
      data: s.results.map(t => t.mean)
    }))

    const objectiveSeries = data.objectiveSeries.map(s => ({
      name: s.name,
      id: s.name,
      data: s.results.map(t => t.mean)
    }))

 
    // const timeErrors = data.series.map(s => ({
    //   name: `${s.name} error`,
    //   linkedTo: s.name,
    //   type: 'errorbar',
    //   data: s.results.map(r => r.time).map(t => [t.mean - t.stdev, t.mean + t.stdev]),
    //   tooltip: {
    //     pointFormat: '(error range: {point.low}-{point.high})<br/>'
    //   }
    // }))

    // const objectiveErrors = data.series.map(s => ({
    //   name: `${s.name} error`,
    //   type: 'errorbar',
    //   linkedTo: s.name,
    //   data: s.results.map(r => r.objective).map(t => [t.mean - t.stdev, t.mean + t.stdev]),
    //   tooltip: {
    //     pointFormat: '(error range: {point.low}-{point.high})<br/>'
    //   }
    // }))


    const series = [lineSeries(timeSeries), lineSeries(objectiveSeries)]
    // const errors = [timeErrors, objectiveErrors]

    console.log(categories)


    function chart (i) {
      Highcharts.chart(`container${i}`, {
        exporting: {
          sourceWidth: 1920,
          scale: 1
        },
        title: {
          text: titles[i]
        },

        tooltip: {
          shared: true,
          headerFormat: `<span style="font-size: 10px">T={point.key.T} D={point.key.D} W={point.key.W}</span><br/>`
        },

        yAxis: {
          title: {
            text: yAxis[i]
          },
          min: 0
        },

        legend: {
          layout: 'vertical',
          align: 'right',
          verticalAlign: 'middle'
        },

        plotOptions: {
          line: {
            dataLabels: {
              enabled: true
            },
            enableMouseTracking: false
          }
        },

        xAxis: {
          categories: categories,
          labels: {
            formatter: function() {
              const size = this.value
              return `T=${size.T} <br /> D=${size.D} <br /> W=${size.W}`
            }
          }
        },

        series: [...series[i], /*..errors[i]*/],

        credits: {
            enabled: false
        },

        responsive: {
          rules: [{
            condition: {
              maxWidth: 700
            },
            chartOptions: {
              legend: {
                layout: 'horizontal',
                align: 'center',
                verticalAlign: 'bottom'
              }
            }
          }]
        }
      });
    }

    chart(0)
    chart(1)
  </script>
</body>
</html>
